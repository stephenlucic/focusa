{% load static %}
<!doctype html>
<html lang="es" data-bs-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Focusa ‚Äî Enfoca tu trabajo{% endblock %}</title>

  <!-- Bootstrap + Icons + Fuente -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Estilos Focusa (separado) -->
    <link rel="stylesheet" href="{% static 'css/focusa.css' %}" />
    <link rel="stylesheet" href="{% static 'css/suscripcion.css' %}" />

  {% block extra_head %}{% endblock %}
</head>
<body>

<!-- Secci√≥n de Planes -->
<section class="pricing-section">
    <div class="container">
        <div class="pricing-header">
            <h1>Planes de Suscripci√≥n Focusa</h1>
            <p>Elige el plan que mejor se adapte a tus necesidades</p>
        </div>

        <div class="pricing-cards">
            <!-- Plan B√°sico -->
            <div class="pricing-card">
                <h2 class="pricing-title">Focusa B√°sico</h2>
                
                <div class="pricing-price">
                    <span class="price-amount">$0</span>
                    <span class="price-period">/mes</span>
                </div>

                <div class="pricing-trial">
                    üéÅ 7 d√≠as de prueba PRO gratis
                </div>

                <ul class="pricing-features">
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span><span class="pricing-limit">10 tareas</span> al mes</span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>M√°ximo <span class="pricing-limit">5 tags</span></span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Vista Kanban</span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Calendario integrado</span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Dashboard b√°sico</span>
                    </li>
                    <li class="locked">
                        <i class="bi bi-lock-fill lock-icon"></i>
                        <span>Exportaci√≥n solo PDF (bloqueado)</span>
                    </li>
                    <li class="locked">
                        <i class="bi bi-lock-fill lock-icon"></i>
                        <span>Reportes avanzados (bloqueado)</span>
                    </li>
                    <li class="locked">
                        <i class="bi bi-lock-fill lock-icon"></i>
                        <span>Exportaci√≥n Excel (bloqueado)</span>
                    </li>
                </ul>
    <button
        type="button"
        class="pricing-btn"
        data-bs-toggle="modal"
        data-bs-target="#pagoModal"
        data-plan-codigo="basic"
        data-plan-nombre="Focusa B√°sico"
        data-plan-precio="0"
    >
        Comenzar Gratis
    </button>
            </div>

            <!-- Plan Pro (Destacado) -->
            <div class="pricing-card featured">
                <div class="pricing-badge">‚≠ê M√°s Popular</div>
                
                <h2 class="pricing-title">Focusa Pro</h2>
                
                <div class="pricing-price">
                    <span class="price-amount">$1.900</span>
                    <span class="price-period">/mes</span>
                </div>

                <div class="pricing-trial">
                    ‚ú® Plan completo sin l√≠mites
                </div>

                <ul class="pricing-features">
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span><span class="pricing-limit">Tareas ilimitadas</span></span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span><span class="pricing-limit">Tags ilimitados</span></span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Vista Kanban avanzada</span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Recordatorios</span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Dashboard avanzado</span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Reportes completos PDF + Excel</span>
                    </li>
                    <li>
                        <i class="bi bi-check-circle-fill"></i>
                        <span>An√°lisis y m√©tricas avanzadas</span>
                    </li>
                </ul>

    <button
        type="button"
        class="pricing-btn"
        data-bs-toggle="modal"
        data-bs-target="#pagoModal"
        data-plan-codigo="pro"
        data-plan-nombre="Focusa Pro"
        data-plan-precio="1900"
    >
        Actualizar a Pro
    </button>
            </div>
        </div>
    </div>
</section>


<!-- Modal de Pago / Selecci√≥n de Plan -->
<div class="modal fade" id="pagoModal" tabindex="-1" aria-labelledby="pagoModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="post" action="{% url 'suscripcion' %}">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="pagoModalLabel">Confirmar suscripci√≥n</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>

        <div class="modal-body">
          <!-- Resumen del plan seleccionado -->
          <div class="mb-3">
            <label class="form-label fw-semibold">Plan seleccionado</label>
            <div>
              <span id="resumen-plan-nombre" class="fw-bold">‚Äî</span>
              <span id="resumen-plan-precio" class="text-muted ms-1"></span>
            </div>
          </div>

          <!-- Select de plan (por si el usuario quiere cambiar dentro del modal) -->
          <div class="mb-3">
            <label for="planSelect" class="form-label">Cambiar plan (opcional)</label>
            <select id="planSelect" name="plan_codigo" class="form-select" required>
              {% for plan in planes %}
                <option value="{{ plan.codigo }}">
                  {{ plan.nombre }} ‚Äî ${{ plan.precio_clp }} / mes
                </option>
              {% endfor %}
            </select>
          </div>

          <!-- M√©todo de pago -->
          <div class="mb-3">
            <label for="metodoPagoSelect" class="form-label">M√©todo de pago</label>
            <select id="metodoPagoSelect" name="metodo_pago" class="form-select" required>
              {% for mp in metodos_pago %}
                <option value="{{ mp.codigo }}">{{ mp.nombre }}</option>
              {% endfor %}
            </select>
          </div>

          <!-- Checkbox de auto-renovaci√≥n (cosm√©tico por ahora) -->
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" value="1" id="autoRenovarCheck" checked disabled>
            <label class="form-check-label" for="autoRenovarCheck">
              Renovar autom√°ticamente cada mes (simulado)
            </label>
          </div>

          <p class="small text-muted mb-0">
            Por ahora este pago es solo de prueba, no se realizar√° ning√∫n cargo real.
          </p>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-primary">Confirmar suscripci√≥n</button>
        </div>
      </form>
    </div>
  </div>
</div>


  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
  document.addEventListener('DOMContentLoaded', function () {
    const pagoModal = document.getElementById('pagoModal');
    const planSelect = document.getElementById('planSelect');
    const resumenNombre = document.getElementById('resumen-plan-nombre');
    const resumenPrecio = document.getElementById('resumen-plan-precio');

    // Cada bot√≥n de las cards tiene data-plan-*
    const botonesPlan = document.querySelectorAll('[data-plan-codigo]');

    botonesPlan.forEach(function (btn) {
      btn.addEventListener('click', function () {
        const codigo = this.getAttribute('data-plan-codigo');
        const nombre = this.getAttribute('data-plan-nombre');
        const precio = this.getAttribute('data-plan-precio');

        // Setear el select de plan
        if (planSelect) {
          planSelect.value = codigo;
        }

        // Actualizar resumen
        if (resumenNombre) {
          resumenNombre.textContent = nombre || 'Plan seleccionado';
        }
        if (resumenPrecio) {
          if (precio && precio !== '0') {
            resumenPrecio.textContent = `‚Äî $${precio} CLP / mes`;
          } else {
            resumenPrecio.textContent = `‚Äî Gratis`;
          }
        }
      });
    });
  });
</script>

  {% block extra_js %}{% endblock %}
</body>
</html>
